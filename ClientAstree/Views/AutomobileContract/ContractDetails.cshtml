@model ClientAstree.Models.AutomobileVM

@{
    ViewData["Title"] = "Contract Details";
}

<style>
    .bg-image {
        background-image: url('/img/fam1.png');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        min-height: 100vh;
    }

    .content-container {
        background-color: rgba(255, 255, 255, 0.8);
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        margin: 20px auto;
    }

    .btn-sign {
        background-color: #4E6B8B;
        color: white;
    }

    .modal-header {
        border-bottom: none;
    }

    .modal-body {
        text-align: left;
    }

    .modal-footer {
        border-top: none;
    }
</style>

<div class="container-fluid bg-image">
    <div class="row">
        <!-- Side Menu on the left -->
        <div class="col-lg-2 col-md-3 col-sm-4 py-0 my-0 px-0 mx-0">
            @Html.Partial("_SideMenu")
        </div>

        <!-- Main Content Area -->
        <div class="col-lg-10 col-md-9 col-sm-8">
            <div class="content-container">
                <h2>Contract Details</h2>
                <hr />
                <dl class="row">
                    <dt class="col-sm-3">Vehicle Make</dt>
                    <dd class="col-sm-9">@Model.VehicleMake</dd>

                    <dt class="col-sm-3">Model</dt>
                    <dd class="col-sm-9">@Model.Model</dd>

                    <dt class="col-sm-3">Vehicle Type</dt>
                    <dd class="col-sm-9">@Model.VehicleType</dd>

                    <dt class="col-sm-3">Registration Number</dt>
                    <dd class="col-sm-9">@Model.RegistrationNumber</dd>

                    <dt class="col-sm-3">Registration Date</dt>
                    <dd class="col-sm-9">@Model.RegistrationDate.ToString("yyyy-MM-dd")</dd>

                    <dt class="col-sm-3">Start Date</dt>
                    <dd class="col-sm-9">@Model.StartDate.ToString("yyyy-MM-dd")</dd>

                    <dt class="col-sm-3">End Date</dt>
                    <dd class="col-sm-9">@Model.EndDate.ToString("yyyy-MM-dd")</dd>

                    <dt class="col-sm-3">Engine Power</dt>
                    <dd class="col-sm-9">@Model.EnginePower HP</dd>

                    <dt class="col-sm-3">Seats Number</dt>
                    <dd class="col-sm-9">@Model.SeatsNumber</dd>

                    <dt class="col-sm-3">Vehicle Value</dt>
                    <dd class="col-sm-9">@Model.VehicleValue DT</dd>

                    <dt class="col-sm-3">True Vehicle Value</dt>
                    <dd class="col-sm-9">@Model.TrueVehicleValue DT</dd>

                    <dt class="col-sm-3">Quota</dt>
                    <dd class="col-sm-9">@Model.Quota</dd>

                    <dt class="col-sm-3">Guarantees</dt>
                    <dd class="col-sm-9">@String.Join(", ", Model.GuaranteesList)</dd>
                </dl>



                


 

                @foreach (var claim in User.Claims)
                {
                        @if(claim.Type=="role"){
         @if(claim.Value=="Admin"){
                    
                        @if ((bool)ViewBag.Validated)
                        {
                            <form action="@Url.Action("UnvalidateAutomobileContract", "AutomobileContract", new { id = Model.Id })" method="post" style="display:inline;">
                                @Html.AntiForgeryToken()
                                <button type="submit" class="btn btn-warning">Unvalidate</button>
                            </form>
                        }
                        else
                        {
                            <form action="@Url.Action("ValidateAutomobileContract", "AutomobileContract", new { id = Model.Id })" method="post" style="display:inline;">
                                @Html.AntiForgeryToken()
                                <button type="submit" class="btn btn-success">Validate</button>
                            </form>
                        }
                        }
                        else{
                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#signContractModal">
                            Sign Contract
                            </button>
                        }
                    }
                }

                <!-- Sign Contract Modal -->
                <div class="modal fade" id="signContractModal" tabindex="-1" role="dialog" aria-labelledby="signContractModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="signContractModalLabel">Sign Contract</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <p>Si vous souhaitez concrétiser ce contrat au niveau de l'agence veuillez fournir les pièces suivantes :</p>
                                <ol>
                                    <li>La pièce d'identité du souscripteur (CIN / passeport).</li>
                                    <li>La carte grise du véhicule</li>
                                    <li>La visite technique et la vignette</li>
                                    <li>Le permis de conduire de l'assuré</li>
                                    <li>Le relevé d'informations (justificatif de la dernière classe Bonus-Malus de l'assuré)</li>
                                    <li>L'attestation de leasing</li>
                                </ol>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                <a href="/AutomobileContract/DownloadPdf?id=@Model.Id" class="btn btn-primary">Download PDF</a>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Sign Contract Modal -->
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
